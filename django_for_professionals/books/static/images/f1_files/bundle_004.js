(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{"AEu/":function(e,t,a){"use strict";a.r(t),a.d(t,"ConversationHiddenRepliesScreen",(function(){return N}));var r=a("KEM+"),n=a.n(r),o=a("ERkP"),c=a("es0u"),i=a("0KEI"),s=a("hqKg"),l=a("oEGd"),d=a("8Lfv"),u=a("G6rE");const g=Object(s.createSelector)(((e,t)=>t.match.params.screenName),((e,t)=>t.match.params.statusId),((e,t)=>"PUSH"===t.history.action),u.e.selectLoggedInUser,((e,t,a,r)=>({loggedInScreenName:r?r.screen_name:void 0,screenName:e,statusId:t,isForwardNavigation:a}))),m={createLocalApiErrorHandler:Object(i.d)("HIDDEN_REPLIES_PAGE"),clearTimelineCache:e=>Object(d.a)(e)};var p=Object(l.g)(g,m),h=a("7JQg"),_=a("xZXe"),b=a("QIgh"),y=a("8UdT"),E=a("IcAo"),f=a("VrCx"),A=a("yy6l");const T=e=>Object(A.a)({component:_.a,createAdditionalProps:()=>({withUnhideReply:e}),displayBlocked:!0,divider:{top:!0,bottom:!0}});var O=({withUnhideReply:e})=>Object(E.a)({},b.b,{[y.b.Tweet]:{handlers:{[f.a.Tweet]:T(e)}}}),k=a("WU0f"),I=a("oQhu"),S=a("yoO3"),L=a("fTQJ"),w=a("VS6U"),P=a("t62R"),v=a("FIs5"),C=a("3XMw"),B=a.n(C);const x=B.a.d806aa19,D=B.a.d80c77dc,R=B.a.ef939f4b,F=B.a.f7f2db4f,j=o.createElement(B.a.I18NFormatMessage,{$i18n:"cf1aca58"},o.createElement(P.c,{link:"https://help.twitter.com/using-twitter/mentions-and-replies#hidden-reply"},B.a.a7511618)),q=()=>o.createElement(v.a,{header:F,message:j});class N extends o.Component{constructor(e){super(e),n()(this,"_getMemoizedModule",Object(I.a)((e=>Object(k.a)(e)))),n()(this,"_getModule",(()=>{const{statusId:e}=this.props;return this._getMemoizedModule(e)})),this._clearTimelineCache()}render(){const{history:e,loggedInScreenName:t,screenName:a,statusId:r}=this.props;return a&&r?o.createElement(S.a,null,o.createElement(w.a,{backLocation:`/${a.toLowerCase()}/status/${r}`,history:e,primaryContent:this._renderPrimaryContent(),sidebarContent:o.createElement(c.a,null),subtitle:a===t?D:R({screenName:a}),title:x})):null}_renderPrimaryContent(){const{loggedInScreenName:e,screenName:t}=this.props;return o.createElement(L.a,{entryConfiguration:O({withUnhideReply:t===e}),module:this._getModule(),renderEmptyState:q,title:x})}_clearTimelineCache(e=this._getModule()){const{clearTimelineCache:t,createLocalApiErrorHandler:a,isForwardNavigation:r}=this.props;r&&t(e).catch(a({}))}}t.default=Object(h.c)({page:"tweet",section:"moderated_replies"})(p(N))},DL4F:function(e,t,a){"use strict";a.r(t),a.d(t,"ConversationAnalyticsScreen",(function(){return B}));var r=a("KEM+"),n=a.n(r),o=(a("kYxP"),a("ERkP")),c=a("v6aA"),i=(a("VAZu"),a("zh9S")),s=a("0KEI"),l=a("hqKg"),d=a("oEGd"),u=a("XOJV");const g=(e,t)=>t.match.params.statusId,m=Object(l.createSelector)(((e,t)=>u.a.selectFetchStatus(e,g(0,t))),g,((e,t)=>u.a.selectHydrated(e,g(0,t))),((e,t,a)=>({fetchStatus:e,statusId:t,tweet:a}))),p={createLocalApiErrorHandler:Object(s.d)("CONVERSATION_ANALYTICS_SCREEN"),fetchTweetIfNeeded:u.a.fetchOneIfNeeded,scribeAction:i.c};var h=Object(d.g)(m,p),_=a("7JQg"),b=a("v//M"),y=a("W5XZ"),E=a("jHSc"),f=a("3XMw"),A=a.n(f),T=a("SrIh"),O=a("Rp9C"),k=a("E0cF"),I=a("q9Zt"),S=a("bPFD"),L=a("rHpw"),w=a("yE5w");const P=A.a.g9079b93,v=A.a.a57daeb1,C=A.a.deaf5b15;class B extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleFetchTweet",(()=>{const{createLocalApiErrorHandler:e,fetchTweetIfNeeded:t,statusId:a}=this.props;t(a).catch(e(y.a))})),n()(this,"_render",(()=>{const{tweet:e}=this.props,t=e&&k.a.getOriginalTweet(e)||void 0;if(!t||t&&t.user.id_str!==this.context.loggedInUserId)return o.createElement(I.a,{onRetry:null,title:P});{const e="";return o.createElement(S.a,{dangerouslyDisableSandbox:!0,onMessage:this._handleIFrameMessage,reportError:T.a,src:`${e}/i/tfb/v1/quick_promote/lite/${t.id_str}`,style:x.iframe})}})),n()(this,"_setAppBarRef",(e=>{this._appBarRef=e})),n()(this,"_handleGoBack",(()=>{const{history:e,location:t}=this.props;e.goBackToNonModalRoute({location:t})})),n()(this,"_handleIFrameMessage",(e=>{if(e&&"quick_promote"===e.name)if("scribe"===e.type){const{scribeAction:t,scribeNamespace:a,tweet:r}=this.props,n=r&&k.a.getOriginalTweet(r)||void 0,o=e.scribeData||{};t({...a,component:"string"==typeof o.component?o.component:"quick_promote",action:"string"==typeof o.uiEvent?o.uiEvent:""},{...o,items:n?[O.a.getTweetItem(n)]:[]})}else if("navigation"===e.type){const{history:e,match:t,tweet:a}=this.props,r=a&&k.a.getOriginalTweet(a);r&&e.push(`/${t.params.screenName}/status/${r.id_str}/${w.a.Rweb}/${w.c.Intro}`)}else"close"===e.type&&this._appBarRef&&this._appBarRef.goBack()}))}componentDidMount(){this._handleFetchTweet()}render(){const{fetchStatus:e,history:t,tweet:a}=this.props,r=a&&k.a.getOriginalTweet(a)||void 0;return o.createElement(E.b,{appBarRef:this._setAppBarRef,backLocation:r?r.permalink:"/",history:t,onBackClick:this._handleGoBack,title:v},o.createElement(b.a,{fetchStatus:e,render:this._render,retryMessage:C}))}}n()(B,"contextType",c.a);const x=L.a.create((e=>({iframe:{flexGrow:1}})));t.default=Object(_.c)({page:"tweet",section:"analytics"})(h(B))},JiIh:function(e,t,a){"use strict";var r=a("ERkP"),n=a("0GBF");t.a=e=>r.createElement(n.a,e)},aH1V:function(e,t,a){"use strict";a.r(t),a.d(t,"QuickPromoteScreen",(function(){return cn}));var r=a("KEM+"),n=a.n(r),o=(a("kYxP"),a("ERkP"));function c(e){throw new Error("Not reachable section reached!")}var i=a("BDX3"),s=a("97Jx"),l=a.n(s),d=a("rxPX"),u=a("0KEI"),g=a("RqPI"),m=a("oEOe"),p=a("kGix"),h=a("3A2y"),_=a("Ssj5");const b=Object.freeze({Any:"AnyGender",Male:"Male",Female:"Female"}),y=Object.freeze({AGE_13_TO_24:"Age13To24",AGE_13_TO_34:"Age13To34",AGE_13_TO_49:"Age13To49",AGE_13_TO_54:"Age13To54",AGE_18_TO_24:"Age18To24",AGE_18_TO_34:"Age18To34",AGE_18_TO_49:"Age18To49",AGE_18_TO_54:"Age18To54",AGE_21_TO_34:"Age21To34",AGE_21_TO_49:"Age21To49",AGE_21_TO_54:"Age21To54",AGE_25_TO_49:"Age25To49",AGE_25_TO_54:"Age25To54",AGE_35_TO_49:"Age35To49",AGE_35_TO_54:"Age35To54",AGE_OVER_13:"AgeOver13",AGE_OVER_18:"AgeOver18",AGE_OVER_21:"AgeOver21",AGE_OVER_25:"AgeOver25",AGE_OVER_35:"AgeOver35",AGE_OVER_50:"AgeOver50"}),E=Object.freeze({[y.AGE_13_TO_24]:{minAge:"13",maxAge:"24"},[y.AGE_13_TO_34]:{minAge:"13",maxAge:"34"},[y.AGE_13_TO_49]:{minAge:"13",maxAge:"49"},[y.AGE_13_TO_54]:{minAge:"13",maxAge:"54"},[y.AGE_18_TO_24]:{minAge:"18",maxAge:"24"},[y.AGE_18_TO_34]:{minAge:"18",maxAge:"34"},[y.AGE_18_TO_49]:{minAge:"18",maxAge:"49"},[y.AGE_18_TO_54]:{minAge:"18",maxAge:"54"},[y.AGE_21_TO_34]:{minAge:"21",maxAge:"34"},[y.AGE_21_TO_49]:{minAge:"21",maxAge:"49"},[y.AGE_21_TO_54]:{minAge:"21",maxAge:"54"},[y.AGE_25_TO_49]:{minAge:"25",maxAge:"49"},[y.AGE_25_TO_54]:{minAge:"25",maxAge:"54"},[y.AGE_35_TO_49]:{minAge:"35",maxAge:"49"},[y.AGE_35_TO_54]:{minAge:"35",maxAge:"54"},[y.AGE_OVER_13]:{minAge:"13"},[y.AGE_OVER_18]:{minAge:"18"},[y.AGE_OVER_21]:{minAge:"21"},[y.AGE_OVER_25]:{minAge:"25"},[y.AGE_OVER_35]:{minAge:"35"},[y.AGE_OVER_50]:{minAge:"50"}}),f=Object.freeze({13:{24:y.AGE_13_TO_24,34:y.AGE_13_TO_34,49:y.AGE_13_TO_49,54:y.AGE_13_TO_54,over:y.AGE_OVER_13},18:{24:y.AGE_18_TO_24,34:y.AGE_18_TO_34,49:y.AGE_18_TO_49,54:y.AGE_18_TO_54,over:y.AGE_OVER_18},21:{34:y.AGE_21_TO_34,49:y.AGE_21_TO_49,54:y.AGE_21_TO_54,over:y.AGE_OVER_21},25:{49:y.AGE_25_TO_49,54:y.AGE_25_TO_54,over:y.AGE_OVER_25},35:{49:y.AGE_35_TO_49,54:y.AGE_35_TO_54,over:y.AGE_OVER_35},50:{over:y.AGE_OVER_50}});a("MvUL"),a("gYAx"),a("gFSH");var A=a("3XMw"),T=a.n(A),O=a("SrIh"),k=a("9OUN"),I=a("06wh");const S=Object.freeze({});function L(e,t){const a=Object(I.a)("rweb/ads/typeahead",e);return{typeaheadApiActionTypes:a,getTypeaheadResults:(r,n)=>(o,c,{api:i})=>{const s=c().ads.typeahead[e][r];if(null!=s&&s.result)return Promise.resolve(s.result);return Object(m.b)(o,{request:t(i),params:n})({actionTypes:a,context:`ADS_TYPEAHEAD_${e}`,meta:{query:r}})},reducer:(e=S,t)=>{switch(t.type){case a.REQUEST:{const{query:a}=t.meta;return{...e,[a]:{fetchStatus:p.a.LOADING}}}case a.FAILURE:{const{error:a,meta:{query:r}}=t;return{...e,[r]:{fetchStatus:p.a.FAILED,error:a}}}case a.SUCCESS:{const{meta:{query:a},payload:r}=t;return{...e,[a]:{fetchStatus:p.a.LOADED,result:r}}}default:return e}}}}const w=L("targetingLocation",(e=>e.AaProxy.getQueriedTargetableLocations)),P=L("forecastAudience",(e=>e.QuickPromote.getAudienceEstimate)),v={targetingLocation:w.reducer,forecastAudience:P.reducer},C={typeahead:Object(k.c)(v)},B=Object(k.c)(C);_.a.register({ads:B});var x=a("yE5w");const D=T.a.i976aff3,R=[p.a.LOADING,p.a.LOADED],F=(e,t)=>(a,r,{api:n})=>{var o,c;const{dailyBudget:i,currency:s}=r().quickPromote.budget,l=pe(r()),{user_id:d}=r().session,u=null==(o=r().quickPromote.account.adsAccount)?void 0:o.id,{ageBucket:g,gender:m,targetedLocations:[{targeting_value:p}]}=r().quickPromote.targeting;if(R.includes(null==(c=r().ads.typeahead.forecastAudience[l])?void 0:c.fetchStatus)||!d||!g)return Promise.resolve();const h=Math.round(1e6*i),_=h,b=j(r());return Object(x.m)(t)(x.k.audienceEstimateCall({dailyBudgetMicros:h,totalBudgetMicros:_,ageBucket:g,gender:m,location:p})),a(P.getTypeaheadResults(l,{userId:d,adAccountId:u,tweetId:e,dailyBudgetMicros:`${h}`,totalBudgetMicros:`${_}`,currency:null!=s?s:"USD",targeting:b})).then((()=>{var e,a;const n=null==(e=r().ads.typeahead.forecastAudience[l])||null==(a=e.result)?void 0:a.estimatedImpressions;n?Object(x.m)(t)(x.k.audienceEstimateSuccess({dailyBudgetMicros:h,totalBudgetMicros:_,ageBucket:g,gender:m,location:p,estimatedImpressions:n})):Object(x.m)(t)(x.k.audienceEstimateFail({dailyBudgetMicros:h,totalBudgetMicros:_,ageBucket:g,gender:m,location:p}))}))};function j(e){const{targetedLocations:t,ageBucket:a,gender:r}=e.quickPromote.targeting;return{geos:t.map((({targeting_value:e})=>({location_id:e}))),age_buckets:[{age_bucket:a}],gender:{gender:r}}}const q=e=>(t,a,{userPersistence:r})=>{const{quickPromote:n}=a(),{targeting:{targetedLocations:o,ageBucket:c,gender:i},budget:{dailyBudget:s,durationDays:l,currency:d}}=n;return r.set("rweb.quickPromoteRedirectBack",e?{platformType:e,ageBucket:c,gender:i,targetedLocations:o,dailyBudget:s,durationDays:l,lastPersisted:(new Date).getTime(),currency:d}:null)},N=(e,t)=>(a,r,{api:n})=>!t&&R.includes(r().quickPromote.account.accountDataFetchStatus)?Promise.resolve():(a(fe(p.a.LOADING)),G(n)(e).then((e=>{if(e){const{account:t}=e;return a(be(t)),M(n)(t.id).then((e=>{a(ye(e)),a(Ee(e[0]||null))}))}})).then((()=>a(fe(p.a.LOADED)))).catch((e=>{throw a(fe(p.a.FAILED)),e}))),G=e=>t=>e.AaProxy.getAccounts().then((t=>Promise.all(t.map((t=>e.AaProxy.getPromoteableUsers(t.id).then((e=>({promoteableUsers:e,account:t}))).catch((()=>{}))))))).then((e=>e.filter(Boolean))).then((e=>e.find((({promoteableUsers:e})=>e.find((e=>e.user_id===t)))))),M=e=>t=>e.AaProxy.getFundingInstruments(t).then((e=>e.filter((({able_to_fund:e,description:t})=>e&&!/no payment method/.test(t))))),U=e=>(t,a)=>{t(Oe(e));const r=Object(g.f)(a());return t(w.getTypeaheadResults(e,{query:e,lang:r}))},H=()=>(e,t,{api:a,scribe:r})=>{if(R.includes(t().quickPromote.targeting.initialTargetedLocationsFetchStatus)||t().quickPromote.targeting.targetedLocations.length)return Promise.resolve();const n=Object(g.l)(t())||"US",o=t().session.language;return e(Ae(p.a.LOADING)),a.AaProxy.getTargetableLocations({countryCode:n,lang:o,locationType:"COUNTRIES"}).then((e=>e.length?e:(Object(O.a)(`Country not found: ${n}`),a.AaProxy.getTargetableLocations({countryCode:"US",lang:o,locationType:"COUNTRIES"})))).then((a=>{if(!a.length){const e=Error("Could not find targetable country for US!");throw Object(O.a)(e),e}if(t().quickPromote.targeting.targetedLocations.length)return Promise.resolve();e(Te(a)),e(Ae(p.a.LOADED))})).catch((t=>{throw e(Ae(p.a.FAILED)),t}))},V=()=>(e,t,{api:a})=>{if(R.includes(t().quickPromote.budget.availableBudgetsFetchStatus))return Promise.resolve();e(Se(p.a.LOADING));const r=me(t());return a.QuickPromote.getBudgets({countryCode:r}).then((({budgets:t,currencyCode:a,defaultBudget:r})=>{e(Le(t,a)),e(we(r)),e(Se(p.a.LOADED))})).catch((t=>{throw e(Se(p.a.FAILED)),t}))},z={account:{adsAccount:null,accountDataFetchStatus:p.a.NONE,fundingInstruments:[],selectedFundingInstrument:null},targeting:{initialTargetedLocationsFetchStatus:p.a.NONE,targetedLocations:[],locationQuery:"",ageBucket:y.AGE_OVER_13,gender:b.Any},budget:{errorMessage:null,dailyBudget:100,durationDays:5,availableBudgets:null,availableBudgetsFetchStatus:p.a.NONE,currency:null},firstLoad:!1,promoteStatus:p.a.NONE,promoteErrorCode:null},Q="rweb/quickPromote/account/set",$="rweb/quickPromote/account/setAdsAccount",X="rweb/quickPromote/account/setFundingInstruments",W="rweb/quickPromote/account/setSelectedFundingInstrument",J="rweb/quickPromote/account/setAccountDataFetchStatus",K="rweb/quickPromote/targeting/set",Z="rweb/quickPromote/targeting/setLocationQuery",Y="rweb/quickPromote/targeting/setInitialTargetedLocationsFetchStatus",ee="rweb/quickPromote/targeting/setTargetedLocations",te="rweb/quickPromote/targeting/setTargetedAgeBucket",ae="rweb/quickPromote/targeting/setTargetedGender",re="rweb/quickPromote/budget/set",ne="rweb/quickPromote/budget/setAvailableBudgetsFetchStatus",oe="rweb/quickPromote/budget/setAvailableBudgets",ce="rweb/quickPromote/budget/setDailyBudget",ie="rweb/quickPromote/budget/setBudgetDuration",se="rweb/quickPromote/budget/setBudgetErrorMessage",le="rweb/quickPromote/setFirstLoad",de="rweb/quickPromote/setPromoteFetchStatus",ue="rweb/quickPromote/setPromoteErrorCode",ge=Object.freeze({REQUEST:"rweb/quickPromote/promoteRequest",SUCCESS:"rweb/quickPromote/promoteSuccess",FAILURE:"rweb/quickPromote/promoteFailure"}),me=e=>{var t,a;const r=(null==(t=e.quickPromote.account)||null==(a=t.adsAccount)?void 0:a.country_code)||Object(g.l)(e)||"US";return"XX"===r?"US":r.toUpperCase()},pe=e=>{const{targeting:{targetedLocations:[{targeting_value:t}],...a},budget:{dailyBudget:r,currency:n}}=e.quickPromote,o=Object(h.a)(a,["initialTargetedLocationsFetchStatus","locationQuery"]);return JSON.stringify({...o,location:t,dailyBudget:r,currency:n})},he=e=>({type:K,payload:{targeting:e}}),_e=e=>({type:re,payload:{budget:e}}),be=e=>({type:$,payload:{adsAccount:e}}),ye=e=>({type:X,payload:{fundingInstruments:e}}),Ee=e=>({type:W,payload:{selectedFundingInstrument:e}}),fe=e=>({type:J,payload:{fetchStatus:e}}),Ae=e=>({type:Y,payload:{fetchStatus:e}}),Te=e=>({type:ee,payload:{targetedLocations:e}}),Oe=e=>({type:Z,payload:{locationQuery:e}}),ke=e=>({type:te,payload:{ageBucket:e}}),Ie=e=>({type:ae,payload:{gender:e}}),Se=e=>({type:ne,payload:{fetchStatus:e}}),Le=(e,t)=>({type:oe,payload:{availableBudgets:e,currency:t}}),we=e=>({type:ce,payload:{dailyBudget:e}}),Pe=e=>({type:ie,payload:{durationDays:e}}),ve=e=>({type:se,payload:{errorMessage:e}}),Ce=e=>({type:le,payload:{firstLoad:e}}),Be=e=>({type:de,payload:{promoteFetchStatus:e}}),xe=e=>({type:ue,payload:{promoteErrorCode:e}}),De=e=>(t,a,{api:r})=>Object(m.b)(t,{request:r.QuickPromote.createPromotion,params:e})({actionTypes:ge,context:"FETCH_PROMOTE"});_.a.register({quickPromote:(e=z,t)=>{switch(t.type){case Q:if(t.payload){const{account:a}=t.payload;return{...e,account:{...e.account,...a}}}break;case K:if(t.payload){const{targeting:a}=t.payload;return{...e,targeting:{...e.targeting,...a}}}break;case re:if(t.payload){const{budget:a}=t.payload;return{...e,budget:{...e.budget,...a}}}break;case le:if(t.payload){const{firstLoad:a}=t.payload;return{...e,firstLoad:a}}break;case $:if(t.payload){const{adsAccount:a}=t.payload;return{...e,account:{...e.account,adsAccount:a}}}break;case X:if(t.payload){const{fundingInstruments:a}=t.payload;return{...e,account:{...e.account,fundingInstruments:a}}}break;case W:if(t.payload){const{selectedFundingInstrument:a}=t.payload;return{...e,account:{...e.account,selectedFundingInstrument:a}}}break;case J:if(t.payload){const{fetchStatus:a}=t.payload;return{...e,account:{...e.account,accountDataFetchStatus:a}}}break;case Y:if(t.payload){const{fetchStatus:a}=t.payload;return{...e,targeting:{...e.targeting,initialTargetedLocationsFetchStatus:a}}}break;case Z:if(t.payload){const{locationQuery:a}=t.payload;return{...e,targeting:{...e.targeting,locationQuery:a}}}break;case ee:if(t.payload){const{targetedLocations:a}=t.payload;return{...e,targeting:{...e.targeting,targetedLocations:a}}}break;case te:if(t.payload){const{ageBucket:a}=t.payload;return{...e,targeting:{...e.targeting,ageBucket:a}}}break;case ae:if(t.payload){const{gender:a}=t.payload;return{...e,targeting:{...e.targeting,gender:a}}}break;case ne:if(t.payload){const{fetchStatus:a}=t.payload;return{...e,budget:{...e.budget,availableBudgetsFetchStatus:a}}}break;case oe:if(t.payload){const{availableBudgets:a,currency:r}=t.payload;return{...e,budget:{...e.budget,availableBudgets:a,currency:r}}}break;case ce:if(t.payload){const{dailyBudget:a}=t.payload;return{...e,budget:{...e.budget,dailyBudget:a}}}break;case ie:if(t.payload){const{durationDays:a}=t.payload;return{...e,budget:{...e.budget,durationDays:a}}}break;case se:if(t.payload){const{errorMessage:a}=t.payload;return{...e,budget:{...e.budget,errorMessage:a}}}break;case de:if(t.payload){const{promoteFetchStatus:a}=t.payload;return{...e,promoteStatus:a}}break;case ue:if(t.payload){const{promoteErrorCode:a}=t.payload;return{...e,promoteErrorCode:a}}break;case ge.REQUEST:return{...e,promoteStatus:p.a.LOADING};case ge.FAILURE:return{...e,promoteStatus:p.a.FAILED};case ge.SUCCESS:return{...e,promoteStatus:p.a.LOADED};default:return t.type,e}return e}});const Re=e=>e.quickPromote.budget.dailyBudget,Fe=e=>e.quickPromote.budget.durationDays,je=e=>e.quickPromote.budget.errorMessage,qe=e=>e.quickPromote.budget.availableBudgets||(e=>{throw new Error(e)})("No budgets found"),Ne=e=>e.quickPromote.budget.currency||"USD",Ge=(e,t)=>{var a,r;const n=pe(e);return null==(a=e.ads.typeahead.forecastAudience[n])||null==(r=a.result)?void 0:r.estimatedImpressions};var Me=Object(d.a)().propsFromState((()=>({dailyBudget:Re,durationDays:Fe,availableBudgets:qe,lang:g.f,currency:Ne,audience:Ge,errorMessage:je}))).propsFromActions((()=>({createLocalApiErrorHandler:Object(u.d)("QUICK_PROMOTE_BUDGET_SELECT_SCREEN"),setDailyBudget:we,setBudgetDuration:Pe,fetchForecastedAudienceIfNeeded:F,setBudgetErrorMessage:ve}))).withAnalytics({page:"quick_promote"}),Ue=a("MWbm"),He=a("t62R"),Ve=a("rHpw");const ze=({children:e,description:t,descriptionDir:a,descriptionTestID:r,label:n,withBottomBorder:c=!0})=>o.createElement(Ue.a,{style:[Qe.descriptionItem,c?Qe.bottomBorder:void 0]},!!n&&o.createElement(He.c,{weight:"bold"},n),!!t&&o.createElement(Ue.a,{style:Qe.descriptionContainer},o.createElement(He.c,{color:"gray600",dir:a,size:"subtext2",style:Qe.descriptionContainer,testID:r},t)),e),Qe=Ve.a.create((e=>({descriptionItem:{backgroundColor:e.colors.cellBackground,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},descriptionContainer:{marginTop:e.spaces.space2},bottomBorder:{borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor}})));var $e=a("iOFy"),Xe=a("Gpeq");const We=({title:e,primaryLabel:t,subtitle:a})=>o.createElement(Ue.a,{style:[Je.bottomBorder,Je.titleContainer]},o.createElement(He.c,{align:"center",size:"large",weight:"heavy"},e),!!t&&o.createElement(Ue.a,{style:Je.primaryLabelContainer},o.createElement(He.c,{align:"center",color:"primary",size:"xLarge"},t)),o.createElement(Ue.a,{style:Je.subtitleContainer},o.createElement($e.a,{align:"center",color:"gray600"},a))),Je=Ve.a.create((e=>({titleContainer:{paddingVertical:e.spaces.space32},primaryLabelContainer:{marginTop:e.spaces.space12},subtitleContainer:{marginTop:e.spaces.space12},bottomBorder:{borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor}})));var Ke="introButton",Ze="nextButton",Ye="targetingScreen",et="targetingLocationScreen",tt="budgetSelectScreen",at="reviewScreen",rt="reviewButton",nt="reviewTargetingDescription",ot="reviewBudgetAndDurationDescription",ct="reviewPaymentPivot",it="targetingLocationPivot",st="backButton",lt="targetingLocationSearch",dt="targetingLocationItem",ut=a("4zmP"),gt=a("9RkS"),mt=a("v6aA"),pt=a("Xrkv");const ht=T.a.dc4a9413,_t=T.a.bad70c09,bt=T.a.c133a39b,yt=T.a.ee5da8f4,Et=T.a.g4bf9cb7,ft=T.a.gc3ce5d9,At=T.a.e542dfd6,Tt=T.a.cb51c854,Ot=T.a.bb7b39e1,kt=T.a.eb9466d0,It=T.a.c21037d0,St=T.a.b07cc9f1,Lt=T.a.ce309bed,wt=T.a.c6c16a51,Pt=T.a.cc49d03f;function vt(e){switch(e){case"AnyGender":return Tt;case"Male":return Ot;case"Female":return kt;default:return Object(O.a)(`Unknown gender: ${e}`),e}}function Ct(e){switch(e){case"COUNTRIES":return It;case"REGIONS":return St;case"METROS":return Lt;case"CITIES":return wt;case"POSTAL_CODES":return Pt;default:return Object(O.a)(`Unknown targeting locationType: ${e}`),e}}function Bt({totalBudgetNum:e,durationDays:t,lang:a,currency:r}){const n=e.toLocaleString(Object(Xe.a)(a),{currency:r,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0});return ht({totalBudget:n,durationLabel:Dt({durationDays:t})})}function xt({numLocations:e}){const t=T.a.ia24dc8c(e);return _t({numLocations:t})}function Dt({durationDays:e}){const t=T.a.ia24dc8c(e);return Et({durationDays:t})}const Rt=T.a.a3a09d48,Ft=T.a.e7eb3683,jt=T.a.d9f6e3cd,qt=T.a.d9d6e10e,Nt=T.a.b3954ec9,Gt=T.a.e1b48db4,Mt=Array(30).fill(null).map(((e,t)=>t+1));class Ut extends o.PureComponent{constructor(...e){super(...e),n()(this,"_fetchForecastedAudienceIfNeeded",(()=>{const{analytics:e,match:{params:{statusId:t}},fetchForecastedAudienceIfNeeded:a,createLocalApiErrorHandler:r}=this.props;a(t,e).catch(r())})),n()(this,"_getSliderProps",((e,t)=>({max:e.length-1,min:0,value:e.indexOf(t)}))),n()(this,"_handleDurationSlider",(e=>{const{setBudgetDuration:t,durationDays:a,analytics:r}=this.props,n=Mt[e];a!==n&&(Object(x.m)(r)(x.k.setBudgetDuration(`${n}`)),t(n),this._fetchForecastedAudienceIfNeeded())})),n()(this,"_handleBudgetSlider",(e=>{const{setDailyBudget:t,availableBudgets:a,dailyBudget:r,analytics:n}=this.props,o=a[e];r!==o&&(Object(x.m)(n)(x.k.setDailyBudget(`${o}`)),t(o),this._fetchForecastedAudienceIfNeeded())}))}componentDidMount(){const{analytics:e}=this.props;Object(x.m)(e)(x.k.budgetSelectPageLoad()),this._fetchForecastedAudienceIfNeeded()}componentWillUnmount(){const{setBudgetErrorMessage:e}=this.props;e(null)}render(){const{durationDays:e,lang:t,dailyBudget:a,availableBudgets:r,currency:n,audience:c,errorMessage:i}=this.props,s=a.toLocaleString(Object(Xe.a)(t),{currency:n,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0}),d=r[0].toLocaleString(Object(Xe.a)(t),{currency:n,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0}),u=r.slice(-1)[0].toLocaleString(Object(Xe.a)(t),{currency:n,style:"currency",maximumFractionDigits:0,minimumFractionDigits:0}),g=c?function({low:e,high:t}){const a=T.a.cf8abf58(e),r=T.a.cf8abf58(t);return ft({audienceLow:a,audienceHigh:r})}(c):"Â ",m=Dt({durationDays:e}),p=Dt({durationDays:Mt[0]}),h=Dt({durationDays:Mt.slice(-1)[0]}),_=this._getSliderProps(r,a),b=this._getSliderProps(Mt,e),y=Bt({totalBudgetNum:a*e,durationDays:e,lang:t,currency:n});return o.createElement(Ue.a,{style:Ht.qpContainer,testID:tt},i&&o.createElement(Ue.a,{style:Ht.gutter},o.createElement(ut.a,{text:i,type:"danger"})),o.createElement(We,{primaryLabel:y,subtitle:g,title:Rt}),o.createElement(ze,{label:Ft},o.createElement(Ue.a,{style:Ht.childSpacing},o.createElement(gt.a,l()({accessibilityLabel:jt,accessibilityLabelValueText:`"${s}"`},_,{maxIcon:o.createElement(He.c,{style:Ht.iconText},u),minIcon:o.createElement(He.c,{style:Ht.iconText},d),onChange:this._handleBudgetSlider,thumbLabel:s})))),o.createElement(ze,{label:qt},o.createElement(Ue.a,{style:Ht.childSpacing},o.createElement(gt.a,l()({accessibilityLabel:Nt,accessibilityLabelValueText:`"${m}"`},b,{maxIcon:o.createElement(He.c,{style:Ht.iconText},h),minIcon:o.createElement(He.c,{style:Ht.iconText},p),onChange:this._handleDurationSlider,thumbLabel:m})))),o.createElement(Ue.a,{style:Ht.disclaimer},o.createElement($e.a,{align:"center",color:"gray600",size:"small"},Gt)))}}n()(Ut,"contextType",mt.a);const Ht=Ve.a.create((e=>({qpContainer:{flex:1},disclaimer:{marginVertical:e.componentDimensions.gutterVertical,marginHorizontal:e.componentDimensions.gutterHorizontal},gutter:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},childSpacing:{marginTop:e.spaces.space4},iconText:{textAlignVertical:"text-bottom"}})));var Vt=Me(Ut),zt=a("XOJV");const Qt=(e,t)=>t.match.params.statusId,$t=(e,t)=>zt.a.selectHydrated(e,Qt(0,t)),Xt=(e,t)=>Object(p.c)(zt.a.selectFetchStatus(e,Qt(0,t)),e.quickPromote.budget.availableBudgetsFetchStatus,e.quickPromote.targeting.initialTargetedLocationsFetchStatus,e.quickPromote.account.accountDataFetchStatus,e.quickPromote.firstLoad?p.a.LOADED:p.a.LOADING),Wt=(e,t)=>e.quickPromote.promoteStatus,Jt=(e,t)=>e.quickPromote.promoteErrorCode,Kt=e=>{const{match:t,history:a}=e,{screenName:r,statusId:n,quickPromotePlatform:o,quickPromoteScreenName:c}=t.params;return((e,t,a,r,n)=>(o,c,{userPersistence:i})=>i.get("rweb.quickPromoteRedirectBack").catch((()=>{})).then((i=>{if(i&&i.platformType&&i.lastPersisted&&(new Date).getTime()-i.lastPersisted<36e5){const{ageBucket:a,gender:r,targetedLocations:s,dailyBudget:l,durationDays:d,platformType:u,currency:g}=i,{currency:m}=c().quickPromote.budget;o(he({ageBucket:a,gender:r,targetedLocations:s})),g===m?(o(_e({dailyBudget:l,durationDays:d})),n.replace(Object(x.g)(e,t,u,x.c.Review))):(o(_e({errorMessage:D})),n.replace(Object(x.g)(e,t,u,x.c.BudgetSelect)))}else r===x.c.Intro||c().quickPromote.firstLoad||n.replace(Object(x.g)(e,t,a,x.c.Intro));o(Ce(!0))})))(r,n,o,c,a)};var Zt=Object(d.a)().propsFromState((()=>({statusId:Qt,fetchStatus:Xt,tweet:$t,promoteFetchStatus:Wt,promoteErrorCode:Jt}))).propsFromActions((e=>({createLocalApiErrorHandler:Object(u.d)("QUICK_PROMOTE_SCREEN"),fetchTweetIfNeeded:zt.a.fetchOneIfNeeded,fetchCurrentTargetingLocationIfNeeded:H,fetchAvailableBudgetsIfNeeded:V,fetchAdsAccountDataIfNeeded:N,handleFirstLoad:()=>Kt(e),setPromoteFetchStatus:Be}))).withAnalytics(x.l),Yt=Object(d.a)().propsFromState((()=>({}))).propsFromActions((()=>({}))).withAnalytics(x.l),ea=a("feu+");const ta=T.a.e1bca506,aa=T.a.e4a4c608,ra=T.a.a219e217;class na extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleGoToAnalytics",(()=>{const{match:e,history:t}=this.props,{screenName:a,statusId:r,quickPromotePlatform:n}=e.params;Object(x.i)(t)(a,r,n)})),n()(this,"_handleClose",(()=>{const{history:e,location:t}=this.props;e.goBackToNonModalRoute({location:t})}))}componentDidMount(){const{analytics:e}=this.props;Object(x.m)(e)(x.k.donePageLoad())}render(){return o.createElement(ea.a,{actionLabel:ra,headline:ta,isFullHeightOnMobile:!0,onAction:this._handleGoToAnalytics,onClose:this._handleClose,subtext:aa,withCloseButton:!1})}}n()(na,"contextType",mt.a);var oa=Yt(na),ca=a("v//M"),ia=a("W5XZ"),sa=a("jHSc");const la=e=>!!e.quickPromote.account.selectedFundingInstrument;var da=Object(d.a)().propsFromState((()=>({hasFundingInstrument:la}))).propsFromActions((()=>({}))).withAnalytics(x.l);const ua=T.a.dcfb0332,ga=T.a.db841200,ma=T.a.hc67be9d;class pa extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleGoToNextPage",(()=>{const{history:e,match:t}=this.props,{screenName:a,statusId:r,quickPromotePlatform:n}=t.params;e.push(Object(x.g)(a,r,n,x.c.Targeting))})),n()(this,"_handleClose",(()=>{const{history:e,location:t}=this.props;e.goBackToNonModalRoute({location:t})}))}componentDidMount(){const{analytics:e,hasFundingInstrument:t}=this.props;Object(x.m)(e)(x.k.introPageLoad({hasFundingInstrument:t}))}render(){const{match:e}=this.props,{quickPromotePlatform:t}=e.params,a=t===x.a.Rweb;return o.createElement(ea.a,{actionLabel:ma,headline:ua,isFullHeightOnMobile:!0,onAction:this._handleGoToNextPage,onClose:this._handleClose,primaryButtonTestID:Ke,subtext:ga,withCloseButton:a})}}n()(pa,"contextType",mt.a);var ha=da(pa),_a=a("tI3i"),ba=a.n(_a),ya=(a("VAZu"),a("zh9S"));const Ea=(e,t)=>t.match.params.statusId,fa=(e,t)=>zt.a.selectHydrated(e,Ea(0,t)),Aa=(e,t)=>zt.a.selectFetchStatus(e,Ea(0,t)),Ta=(e,t)=>e.quickPromote.account.adsAccount;var Oa=Object(d.a)().propsFromState((()=>({fetchStatus:Aa,tweet:fa,adsAccount:Ta}))).propsFromActions((e=>({createLocalApiErrorHandler:Object(u.d)("QUICK_PROMOTE_PAYMENT_SCREEN"),fetchTweetIfNeeded:zt.a.fetchOneIfNeeded,scribeAction:ya.c,savePlatformRedirectBackState:()=>q(e.match.params.quickPromotePlatform),fetchAdsAccountDataIfNeeded:N}))).withAnalytics(x.l),ka=a("Rp9C"),Ia=a("E0cF"),Sa=a("bPFD");class La extends o.PureComponent{constructor(...e){super(...e),n()(this,"_setAppBarRef",(e=>{this._appBarRef=e})),n()(this,"_handleIFrameMessage",(e=>{const{analytics:t,tweet:a}=this.props;if(e&&"quick_promote"===e.name)if("scribe"===e.type){const r=a&&Ia.a.getOriginalTweet(a)||void 0,n=r?[ka.a.getTweetItem(r)]:[],o=e.scribeData||{},c="string"==typeof o.component?o.component:"quick_promote",i="string"==typeof o.uiEvent?o.uiEvent:"";t.scribe({component:c,action:i,data:{items:n}})}else if("navigation"===e.type){const{history:e,match:t,fetchAdsAccountDataIfNeeded:a,createLocalApiErrorHandler:r}=this.props,{screenName:n,statusId:o,quickPromotePlatform:c}=t.params;ba()(!!this.context.loggedInUserId,"loggedInUserId must be defined"),a(this.context.loggedInUserId,!0).catch(r()),e.push(`/${n}/status/${o}/${c}/${x.c.Review}`)}else"close"===e.type&&this._appBarRef&&this._appBarRef.goBack()}))}componentDidMount(){const{savePlatformRedirectBackState:e,analytics:t,adsAccount:a,match:r}=this.props,{quickPromotePlatform:n,statusId:o}=r.params;e();const c=Object(x.f)(n,a,o);Object(x.m)(t)(x.k.paymentPageLoad(c.url)),c.isSameHost||(window.location.href=c.url)}render(){const{adsAccount:e,match:t}=this.props,{quickPromotePlatform:a,statusId:r}=t.params,n=Object(x.f)(a,e,r);return n.isSameHost?o.createElement(Sa.a,{dangerouslyDisableSandbox:!0,onMessage:this._handleIFrameMessage,reportError:O.a,src:n.url,style:wa.iframe}):null}}n()(La,"contextType",mt.a);const wa=Ve.a.create((e=>({iframe:{flexGrow:1}})));var Pa=Oa(La);const va=(e,t)=>e.quickPromote.targeting.targetedLocations,Ca=(e,t)=>e.quickPromote.targeting.ageBucket,Ba=(e,t)=>e.quickPromote.targeting.gender,xa=(e,t)=>e.quickPromote.budget.dailyBudget,Da=(e,t)=>e.quickPromote.budget.durationDays,Ra=e=>e.quickPromote.budget.currency||"USD",Fa=e=>e.quickPromote.account.selectedFundingInstrument,ja=e=>e.quickPromote.account.adsAccount,qa=e=>e.quickPromote.promoteStatus,Na=e=>e.quickPromote.promoteErrorCode,Ga=({history:e,match:t})=>a=>{const{screenName:r,statusId:n,quickPromotePlatform:o}=t.params;return((e,t,a,r,n)=>(o,c,{api:i})=>{var s;const l=j(c()),{session:{user_id:d},quickPromote:{targeting:{ageBucket:u,gender:g,targetedLocations:[{targeting_value:m}]},budget:{dailyBudget:p,durationDays:h},account:{selectedFundingInstrument:_}}}=c(),b=null==(s=c().quickPromote.account.adsAccount)?void 0:s.id;if(R.includes(c().quickPromote.promoteStatus))return Promise.resolve();if(!b||!d)return Object(x.m)(n)(x.k.promotionError("Unauthorized")),o(xe("Unauthorized")),Promise.resolve();if(!_)return Object(x.m)(n)(x.k.promotionError("MissingFundingInstrument")),o(xe("MissingFundingInstrument")),Promise.resolve();o(xe(null));const y=_.id,E=Math.round(1e6*p),f=E*h;return Object(x.m)(n)(x.k.promotionCall({dailyBudgetMicros:E,totalBudgetMicros:f,ageBucket:u,gender:g,location:m})),o(De({userId:d,accountId:b,fundingInstrumentId:y,tweetId:a,budget:{daily_local_micros:`${E}`,total_local_micros:`${f}`},targeting:l})).catch((()=>(o(xe("NetworkError")),Object(x.m)(n)(x.k.promotionError("NetworkError")),{type:"fail"}))).then((c=>{var i,s,l;if("fail"!==c.type){var u;if("QuickPromoteError"===(null==(i=c.quick_promote_campaign_v2)?void 0:i.__typename))return o(xe(c.quick_promote_campaign_v2.error_code)),Object(x.m)(n)(x.k.promotionError((null==(u=c.quick_promote_campaign_v2)?void 0:u.error_code)||"QuickPromoteError")),o(N(d,!0));if("PromotionIneligible"===(null==(s=c.quick_promote_campaign_v2)?void 0:s.response_code))Object(x.m)(n)(x.k.promotionError("PromotionIneligible")),o(xe("PromotionIneligible"));else if(null!=(l=c.quick_promote_campaign_v2)&&l.response_code)return void e.push(Object(x.g)(t,a,r,x.c.Done))}}))})(e,r,n,o,a)};var Ma=Object(d.a)().propsFromState((()=>({targetedLocations:va,ageBucket:Ca,gender:Ba,dailyBudget:xa,durationDays:Da,lang:g.f,country:me,currency:Ra,fundingInstrument:Fa,adsAccount:ja,promoteStatus:qa,promoteErrorCode:Na}))).propsFromActions((e=>({createLocalApiErrorHandler:Object(u.d)("QUICK_PROMOTE_REVIEW_SCREEN"),clearPersistedRedirectBackState:()=>q(),createPromotion:Ga(e)}))).withAnalytics(x.l),Ua=a("csss"),Ha=a("/yvb"),Va=a("shC7");const za=T.a.c3c57e3e,Qa=T.a.h06724b4,$a=T.a.b069d89c,Xa=T.a.a3a09d48,Wa=T.a.e36bce63,Ja=T.a.i41612d9,Ka=T.a.ed8bb5af,Za=T.a.be2dc078,Ya=T.a.da2805d1,er=T.a.ef4602eb,tr=T.a.a4db098b,ar=T.a.ef7e3916;class rr extends o.PureComponent{constructor(...e){super(...e),n()(this,"_getPaymentDescription",(()=>{const{adsAccount:e}=this.props;return e&&e.timezone&&e.country_code?Ka:Za})),n()(this,"_handlePromote",(()=>{const{createPromotion:e,analytics:t}=this.props;Object(x.m)(t)(x.k.promotionClick()),e(t)})),n()(this,"_getErrorMessage",(()=>{const{promoteErrorCode:e,promoteStatus:t}=this.props;if(!e)return t===p.a.LOADED?Ya:null;switch(e){case"MissingFundingInstrument":case"InvalidPaymentMethod":return ar;case"CampaignCreationFailed":case"PromotionIneligible":return tr;default:return er}}))}componentDidMount(){const{analytics:e,clearPersistedRedirectBackState:t,fundingInstrument:a}=this.props;t();const r=!!a;Object(x.m)(e)(x.k.reviewPageLoad({hasFundingInstrument:r}))}render(){const{targetedLocations:e,ageBucket:t,gender:a,dailyBudget:r,durationDays:n,lang:c,country:i,currency:s,fundingInstrument:l,match:d,promoteStatus:u}=this.props,g=function({minAge:e,maxAge:t}){return t?bt({minAge:e,maxAge:t}):yt({minAge:e})}(E[t]),m=function({locations:e,formattedAge:t,gender:a}){const r=e.length;return At({locations:Object(pt.a)(e),locationsHeading:xt({numLocations:r}),formattedAge:t,gender:a})}({locations:e.map((({localized_name:e})=>e)),formattedAge:g,gender:vt(a)}),p=Bt({totalBudgetNum:r*n,durationDays:n,lang:c,currency:s}),{screenName:h,statusId:_,quickPromotePlatform:b}=d.params,y=this._getErrorMessage();return o.createElement(o.Fragment,null,o.createElement(Ue.a,{style:nr.qpContainer,testID:at},y&&o.createElement(Ue.a,{style:nr.gutter},o.createElement(ut.a,{text:y,type:"danger"})),o.createElement(We,{subtitle:Qa,title:za}),o.createElement(ze,{description:m,descriptionTestID:nt,label:$a}),o.createElement(ze,{description:p,descriptionDir:Va.a.getConstants().isRTL?"rtl":"ltr",descriptionTestID:ot,label:Xa}),o.createElement(Ua.a,{description:l?l.description:o.createElement(He.c,{color:"primary",size:"small"},this._getPaymentDescription()),label:o.createElement(He.c,{weight:"bold"},Wa),link:l?void 0:Object(x.g)(h,_,b,x.c.Payment),testID:ct})),o.createElement(Ue.a,{style:nr.bottomElements},o.createElement(Ha.a,{disabled:!l||R.includes(u),onPress:this._handlePromote,size:"normalLarge",testID:rt,type:"primary"},Ja),o.createElement($e.a,{style:nr.terms},(f=i,o.createElement(T.a.I18NFormatMessage,{$i18n:"c99d7100"},o.createElement(He.c,{link:Object(x.h)(f)},T.a.d56b5ac3))))));var f}}n()(rr,"contextType",mt.a);const nr=Ve.a.create((e=>({qpContainer:{flex:1},bottomElements:{marginHorizontal:e.spaces.space12,marginVertical:e.spaces.space32},terms:{marginTop:e.spaces.space12,textAlign:"center",color:e.colors.gray600,fontSize:e.fontSizes.subtext3},gutter:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical}})));var or=Ma(rr),cr=a("zCf4");const ir=(e,t)=>{const a=lr(e,t);return e.ads.typeahead.targetingLocation[a]},sr=(e,t)=>{var a;const r=lr(e,t);return null==(a=e.ads.typeahead.targetingLocation[r])?void 0:a.fetchStatus},lr=(e,t)=>e.quickPromote.targeting.locationQuery,dr=(e,t)=>e.quickPromote.targeting.targetedLocations;var ur=Object(d.a)().propsFromState((()=>({targetingLocationQuery:lr,targetingLocations:ir,targetedLocations:dr,fetchStatus:sr,userCountry:g.l}))).propsFromActions((()=>({setTargetedLocations:Te,setAndFetchTargetingLocationQuery:U,setTargetingLocationQuery:Oe,createLocalApiErrorHandler:Object(u.d)("QUICK_PROMOTE_TARGETING_LOCATION_SCREEN")}))).withAnalytics(x.l),gr=a("SrCX"),mr=a("VwDm"),pr=a("G1WX"),hr=a("cCdp"),_r=a("xKuM"),br=a("zrOZ"),yr=a("kevv");const Er=T.a.cc642518,fr=T.a.i0e8c3c6,Ar=T.a.deaf5b15,Tr=T.a.f69ad048,Or=Object.freeze({COUNTRIES:0,REGIONS:1,METROS:2,CITIES:3,POSTAL_CODES:4}),kr=Object.freeze({[x.d.CurrentCountryMatch]:0,[x.d.Match]:1,[x.d.NoMatch]:2});class Ir extends o.PureComponent{constructor(...e){super(...e),n()(this,"state",{errorMessage:null}),n()(this,"_renderSearch",(()=>{const{fetchStatus:e,targetingLocationQuery:t}=this.props;return o.createElement(Sr,{onBack:this._handleGoBack,onChange:this._handleTargetingLocationChange,onClear:this._handleClear,targetingLocationQuery:t},o.createElement(Ue.a,null,o.createElement(He.c,{style:Lr.headingText,weight:"heavy"},fr)),o.createElement(pr.a,{fetchStatus:e,render:this._renderSearchList,retryMessage:Ar}))})),n()(this,"_handleClear",(()=>{const{setTargetingLocationQuery:e}=this.props;e("")})),n()(this,"_renderSearchList",(()=>{const{targetedLocations:e}=this.props,t=Object(br.a)(e.map((({targeting_value:e})=>e))),a=this._getTargetingLocationOptions();return o.createElement(Ue.a,{style:Lr.overflow},a.map((({location_type:e,targeting_value:a,localized_name:r})=>o.createElement(hr.a,{checked:t.has(a),helpText:Ct(e),key:a,label:r,name:a,onChange:this._handleSearchSelect,testID:dt}))))})),n()(this,"_getTargetingLocationOptions",(()=>{var e,t,a;const{targetingLocations:r,userCountry:n,targetingLocationQuery:o}=this.props,c=null!=(e=null==r||null==(t=r.result)||null==(a=t[0])?void 0:a.locations)?e:[],i=Object(x.e)(n||"US"),s=c.filter((({country_code:e,localized_name:t})=>i(t,e,o)!==x.d.NoMatch));return Object(yr.a)(s,[({country_code:e,localized_name:t})=>{const a=i(t,e,o);return kr[a]},({location_type:e,localized_name:t})=>{var a;return null!=(a=Or[e])?a:(e=>{Object(O.a)(`Quick Promote: Unknown location type: ${e}. Expected one of {${Object.keys(Or).join(", ")}}`)})(e)||Object.keys(Or).length},({localized_name:e})=>e],"asc")})),n()(this,"_handleSearchSelect",((e,t)=>{const{setTargetedLocations:a,analytics:r,setTargetingLocationQuery:n}=this.props;if(t){this.setState({errorMessage:null});const t=this._getTargetingLocationOptions().find((({targeting_value:t})=>t===e));t?(Object(x.m)(r)(x.k.setTargetingLocation({id:t.targeting_value,locationType:t.location_type,countryCode:t.country_code})),a([t]),this._handleGoBack()):Object(O.a)(`Quick Promote: could not find "${e}" in list of targeting options`)}else Object(x.m)(r)(x.k.targetingLocationError()),this.setState({errorMessage:Tr});n("")})),n()(this,"_renderSelected",(()=>{const{targetedLocations:e,targetingLocationQuery:t}=this.props,{errorMessage:a}=this.state;return o.createElement(Sr,{onBack:this._handleGoBack,onChange:this._handleTargetingLocationChange,onClear:this._handleClear,targetingLocationQuery:t},o.createElement(Ue.a,null,a&&o.createElement(Ue.a,{style:Lr.gutter},o.createElement(ut.a,{text:a,type:"danger"})),o.createElement(He.c,{style:Lr.headingText,weight:"heavy"},xt({numLocations:e.length}))),o.createElement(Ue.a,null,e.map((({localized_name:e,targeting_value:t,location_type:a})=>o.createElement(hr.a,{checked:!0,helpText:Ct(a),key:t,label:e,name:t,onChange:this._handleSearchSelect,testID:dt})))))})),n()(this,"_handleGoBack",(()=>{const{history:e,location:t,match:a}=this.props,{quickPromotePlatform:r,quickPromoteScreenName:n,screenName:o,statusId:c}=a.params;Object(x.j)(e,t)(o,c,r,n)})),n()(this,"_handleTargetingLocationChange",(e=>{const t=e.target.value,{createLocalApiErrorHandler:a,setAndFetchTargetingLocationQuery:r,analytics:n}=this.props;Object(x.m)(n)(x.k.targetingLocationSearch(t)),r(t).catch(a())}))}componentDidMount(){const{analytics:e}=this.props;Object(x.m)(e)(x.k.targetingLocationPageLoad())}componentWillUnmount(){this._handleClear()}render(){const{targetingLocationQuery:e}=this.props;return e?this._renderSearch():this._renderSelected()}}n()(Ir,"contextType",mt.a);const Sr=({onBack:e,onChange:t,onClear:a,targetingLocationQuery:r,children:n})=>o.createElement(Ue.a,{style:Lr.qpContainer,testID:et},o.createElement(_r.a,{leftControl:o.createElement(i.a,{onClick:e}),middleControl:o.createElement(gr.a,{Icon:mr.a,autoFocus:!0,name:"locationTargetingInput",onChange:t,onClear:a,placeholder:Er,style:Lr.input,testID:lt,value:r,withClearButton:!0})}),n),Lr=Ve.a.create((e=>({qpContainer:{flex:1},input:{marginVertical:e.spaces.space12},headingText:{fontSize:e.fontSizes.headline1,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical,borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.colors.borderColor,borderTopWidth:1,borderTopStyle:"solid",borderTopColor:e.colors.borderColor},gutter:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},overflow:{flex:"1 1 200px",overflowY:"auto"}})));var wr=ur(Ir);const Pr=(e,t)=>e.quickPromote.targeting.targetedLocations,vr=(e,t)=>e.quickPromote.targeting.gender,Cr=(e,t)=>e.quickPromote.targeting.ageBucket;var Br=Object(d.a)().propsFromState((()=>({targetedLocations:Pr,selectedGender:vr,selectedAgeBucket:Cr}))).propsFromActions((()=>({setTargetedAgeBucket:ke,setTargetedGender:Ie}))).withAnalytics(x.l),xr=a("JiIh"),Dr=a("V2ml"),Rr=a("J4ZH"),Fr=a("mN6z");const jr=T.a.hba1d105,qr=T.a.cba0133d,Nr=T.a.e1efbead,Gr=T.a.c6ff7c1f,Mr=T.a.b555fb45,Ur=T.a.a8d0108d,Hr=[b.Any,b.Female,b.Male].map((e=>({label:vt(e),value:e}))),Vr=T.a.j2c03e12,zr=["13","18","21","25","35","50"],Qr=[void 0,void 0,void 0,"24","34","49","54"],$r=Object(Rr.a)((Xr=E,Object.values(Xr)),(e=>e.maxAge||"over"));var Xr;const Wr=Qr.length;function Jr(e,t){var a;if(e&&t)return null==(a=f[e])?void 0:a[t]}class Kr extends o.PureComponent{constructor(...e){super(...e),n()(this,"_handleGenderChange",((e,t)=>{const{setTargetedGender:a,analytics:r}=this.props;a(t),Object(x.m)(r)(x.k.setTargetingGender(t))})),n()(this,"_handleAgeBucketChange",(([e,t],a)=>{const{selectedAgeBucket:r,setTargetedAgeBucket:n,analytics:o}=this.props,c=this._sliderValueFromSelectedAgeBucket(r);if(!Object(Fr.a)(c,[e,t]))if(a){const a=zr[e];if(!a)return;const r=Jr(a,t===Wr?"over":Qr[t]);if(r)Object(x.m)(o)(x.k.setTargetingAgeBucket(r)),n(r);else{const e=Object.keys(f[a])[0];this._setAgeBucket({minAge:a,maxAge:e})}}else{const a=t===Wr?"over":Qr[t];if(!a)return;const r=Jr(zr[e],a);if(r)Object(x.m)(o)(x.k.setTargetingAgeBucket(r)),n(r);else{const{minAge:e}=$r[a].slice(-1)[0];this._setAgeBucket({minAge:e,maxAge:a})}}})),n()(this,"_setAgeBucket",(({minAge:e,maxAge:t})=>{const{setTargetedAgeBucket:a,analytics:r}=this.props,n=f[e][t||"over"];if(!n)throw new Error(`Age bucket not found for minAge: "${e}", maxAge: "${t||"<empty>"}"`);Object(x.m)(r)(x.k.setTargetingAgeBucket(n)),a(n)}))}componentDidMount(){const{analytics:e}=this.props;Object(x.m)(e)(x.k.targetingPageLoad())}_sliderValueFromSelectedAgeBucket(e){const{minAge:t,maxAge:a}=E[e];return[zr.indexOf(t),a?Qr.indexOf(a):Wr]}render(){const{match:e,targetedLocations:t,selectedGender:a,selectedAgeBucket:r}=this.props,{screenName:n,statusId:c,quickPromotePlatform:i}=e.params,s=xt({numLocations:t.length}),{minAge:l,maxAge:d}=E[r],{minAge:u}=E[y.AGE_OVER_13],g=this._sliderValueFromSelectedAgeBucket(r),m=d||Vr;return o.createElement(Ue.a,{style:Zr.qpContainer,testID:Ye},o.createElement(We,{subtitle:qr,title:jr}),o.createElement(Ua.a,{description:Object(pt.a)(t.map((({localized_name:e})=>e))),label:o.createElement(He.c,{weight:"bold"},s),link:Object(x.g)(n,c,i,x.c.TargetingLocation),testID:it}),o.createElement(ze,{label:Nr},o.createElement(Ue.a,{style:Zr.childSpacing},o.createElement(xr.a,{endThumbAccessibilityLabel:Mr,endThumbAccessibilityLabelValueText:`"${m}"`,endThumbLabel:m,max:Wr,maxIcon:o.createElement(He.c,{style:Zr.iconText},Vr),min:0,minIcon:o.createElement(He.c,{style:Zr.iconText},u),onChange:this._handleAgeBucketChange,startThumbAccessibilityLabel:Gr,startThumbAccessibilityLabelValueText:`"${l}"`,startThumbLabel:l,value:g}))),o.createElement(ze,{label:Ur,withBottomBorder:!1},o.createElement(Ue.a,{style:Zr.childSpacing},o.createElement(Dr.a,{name:"gender",onChange:this._handleGenderChange,options:Hr,value:a}))))}}n()(Kr,"contextType",mt.a);const Zr=Ve.a.create((e=>({qpContainer:{flex:1},childSpacing:{marginTop:e.spaces.space4},iconText:{textAlignVertical:"text-bottom"}})));var Yr=Br(Kr),en=a("q9Zt"),tn=a("JYMr");const an=T.a.a065172e,rn=T.a.cfcdb4a1,nn=T.a.dcfb0332,on=T.a.c1df579e;class cn extends o.PureComponent{constructor(...e){super(...e),n()(this,"_getRetweetOrTweet",(()=>{const{tweet:e}=this.props;return e?Ia.a.getOriginalTweet(e):e})),n()(this,"_handleFetchTweet",(()=>{const{createLocalApiErrorHandler:e,fetchTweetIfNeeded:t,statusId:a}=this.props;return t(a).catch(e(ia.a))})),n()(this,"_handleFetchCurrentTargetingLocation",(()=>{const{createLocalApiErrorHandler:e,fetchCurrentTargetingLocationIfNeeded:t}=this.props;return t().catch(e())})),n()(this,"_handleFetchBudgetOptions",(()=>{const{createLocalApiErrorHandler:e,fetchAvailableBudgetsIfNeeded:t}=this.props;return t().catch(e())})),n()(this,"_handleFetchAdsAccountData",(()=>{const{createLocalApiErrorHandler:e,fetchAdsAccountDataIfNeeded:t}=this.props;return ba()(!!this.context.loggedInUserId,"loggedInUserId must be defined"),t(this.context.loggedInUserId).catch(e())})),n()(this,"_render",(()=>{const{history:e}=this.props,t=this._getRetweetOrTweet();return!t||t&&t.user.id_str!==this.context.loggedInUserId?o.createElement(sa.b,{history:e,onBackClick:this._handleGoBack,title:nn},o.createElement(en.a,{onRetry:null,title:an})):this._renderPage()})),n()(this,"_renderHeader",(()=>null)),n()(this,"_renderPage",(()=>{const{match:e,promoteFetchStatus:t,promoteErrorCode:a}=this.props,{quickPromoteScreenName:r,screenName:n,statusId:o,quickPromotePlatform:i}=e.params,s=e=>Object(x.g)(n,o,i,e);switch(r){case"intro":return this._renderSplashPage();case"targeting":{const e=s(x.c.BudgetSelect);return this._renderProgressPage(x.b.Targeting,e)}case"budget_select":{const e=s(x.c.Review);return this._renderProgressPage(x.b.BudgetSelect,e)}case"review":{const e=[p.a.LOADING,p.a.LOADED].includes(t)&&!a;return this._renderProgressPage(e?x.b.Finish:x.b.Review)}case"payment":return this._renderProgressPage(x.b.Review);case"targeting_location":return this._renderPopupPage();case"done":return this._renderSplashPage();default:throw c()}})),n()(this,"_renderProgressPage",((e,t)=>{const{history:a}=this.props;return o.createElement(sa.b,{documentTitle:nn,history:a,renderHeader:this._renderHeader},o.createElement(_r.a,{leftControl:o.createElement(i.a,{autofocus:!0,onClick:this._handleGoBack,testID:st}),rightControl:t&&o.createElement(Ha.a,{link:t,pullRight:!0,testID:Ze,type:"text"},on)}),o.createElement(tn.a,{progress:e,style:sn.progressBar}),o.createElement(Ue.a,{style:sn.noScrollView},this._renderRoutes()))})),n()(this,"_renderPopupPage",(()=>{const{history:e}=this.props;return o.createElement(sa.b,{documentTitle:nn,history:e,renderHeader:this._renderHeader},this._renderRoutes())})),n()(this,"_renderSplashPage",(()=>this._renderRoutes())),n()(this,"_renderRoutes",(()=>{const{match:e}=this.props,{quickPromoteScreenName:t}=e.params;switch(t){case"intro":return o.createElement(cr.b,{component:ha});case"targeting":return o.createElement(cr.b,{component:Yr});case"targeting_location":return o.createElement(cr.b,{component:wr});case"budget_select":return o.createElement(cr.b,{component:Vt});case"review":return o.createElement(cr.b,{component:or});case"payment":return o.createElement(cr.b,{component:Pa});case"done":return o.createElement(cr.b,{component:oa});default:throw c()}})),n()(this,"_handleGoBack",(()=>{const{history:e,match:t,location:a,analytics:r}=this.props,{screenName:n,statusId:o,quickPromotePlatform:c,quickPromoteScreenName:i}=t.params;Object(x.m)(r)(x.k.back(i)),Object(x.j)(e,a)(n,o,c,i)})),n()(this,"_handleRequestRetry",(()=>{const{analytics:e,match:t}=this.props,{quickPromoteScreenName:a}=t.params;Object(x.m)(e)(x.k.reload(a)),window.location.reload()}))}componentDidMount(){const{analytics:e,promoteFetchStatus:t,setPromoteFetchStatus:a,match:r}=this.props,{quickPromoteScreenName:n}=r.params;return p.a.LOADED===t&&n!==x.c.Done&&a(p.a.NONE),Promise.all([this._handleFetchTweet(),this._handleFetchCurrentTargetingLocation(),this._handleFetchAdsAccountData()]).then((()=>this._handleFetchBudgetOptions())).then((()=>{const{handleFirstLoad:e}=this.props;return e()})).catch((t=>{throw Object(x.m)(e)(x.k.pageLoadFail(t.message)),t}))}render(){const{fetchStatus:e,history:t}=this.props;return e!==p.a.LOADED?o.createElement(sa.b,{documentTitle:nn,history:t,renderHeader:this._renderHeader},o.createElement(ca.a,{fetchStatus:e,onRequestRetry:this._handleRequestRetry,render:this._render,retryMessage:rn})):o.createElement(ca.a,{fetchStatus:e,onRequestRetry:this._handleRequestRetry,render:this._render,retryMessage:rn})}}n()(cn,"contextType",mt.a);const sn=Ve.a.create((e=>({progressBar:{backgroundColor:e.colors.gray50},noScrollView:{overflowX:"hidden",flex:1}}))),ln=Zt(cn);t.default=ln},kevv:function(e,t,a){"use strict";var r=a("BcsE"),n=a("aTAq");const o=(e,t)=>{if(Object(r.a)(e)&&Object(r.a)(t)){if(e>t)return 1;if(e<t)return-1}else if(Object(n.a)(e)&&Object(n.a)(t)){if(e>t)return 1;if(e<t)return-1}return 0};t.a=(e,t,a)=>{const c=Object(n.a)(a)?Array(t.length).fill(a):a,i=t.map((e=>Object(n.a)(e)?t=>{const a="object"==typeof t?null==t?void 0:t[e]:void 0;return Object(n.a)(a)||Object(r.a)(a)?a:void 0}:e));return e.concat().sort(((e,t)=>(a,r)=>{for(let n=0;n<e.length;n++){const c=e[n],i=t[n]||"asc",s=o(c(a),c(r));if(0!==s)return"desc"===i?-1*s:s}return 0})(i,c))}},z4TA:function(e,t,a){"use strict";a.r(t),a.d(t,"ConversationScreen",(function(){return De}));var r=a("KEM+"),n=a.n(r),o=(a("kYxP"),a("MvUL"),a("aeN7")),c=a("ERkP"),i=a("s4rk"),s=a("pxuL"),l=a("zI2C"),d=a("6ZtA"),u=a("es0u"),g=a("zh9S"),m=a("6/RC"),p=a("0KEI"),h=a("hqKg"),_=a("oEGd"),b=a("8Lfv"),y=a("QK5w"),E=a("RqPI"),f=a("If64"),A=a("pNZL"),T=a("XOJV"),O=a("Mx3A");const k=(e,t)=>e.location&&e.location.state&&e.location.state[t],I=(e,t)=>{const a=k(t,"focal");return a||S(e,t)},S=(e,t)=>{const{location:a,match:r}=t;return r.params&&r.params.statusId?r.params.statusId:a.query&&a.query.tweet_id&&"string"==typeof a.query.tweet_id?a.query.tweet_id:""},L=Object(h.createSelector)(y.a,((e,t)=>k(t,"contextTweetId")),((e,t)=>T.a.selectFetchStatus(e,I(e,t))),((e,t)=>"PUSH"===t.history.action),((e,t)=>{if(!m.canUseDOM)return!1;const{location:a}=t,r=a.query,n=Object(y.a)(e,t);return Object(O.c)({query:r,httpReferer:n?"":document.referrer||"",requestUrl:window.location.href,emptyIfServerRendered:!1}).referral_type===O.a.Web}),((e,t)=>{const a=k(t,"referrer"),r=I(e,t);return!!a&&a.includes(`/i/topics/tweet/${r}`)}),((e,t)=>k(t,"promotedContent")),((e,t)=>t.location.query&&"string"==typeof t.location.query.cxt?t.location.query.cxt:void 0),((e,t)=>{const a=I(e,t),r=T.a.selectHydrated(e,a);return r&&r.conversation_id_str?T.a.selectHydrated(e,r.conversation_id_str):null}),((e,t)=>T.a.selectHydrated(e,I(e,t))),((e,t)=>t.match.params.screenName),((e,t)=>k(t,"socialContext")),f.a,I,S,((e,t)=>k(t,"contextualClientEventInfo")),A.a,((e,t)=>k(t,"overflow")),E.f,((e,t,a,r,n,o,c,i,s,l,d,u,g,m,p,h,_,b,y)=>({contextTweetId:t,initialFetchStatus:a,isForwardNavigation:r,isInitialScreen:!e,isReferralSource:n,isReferredFromExploreTopics:o,promotedContent:c,richLandingContextId:i,rootTweet:s,focalTweet:l,screenName:d,selectedTweetId:p,socialContext:u,startLocation:g,statusId:m,contextualClientEventInfo:h,tweetDetailNav:_,overflowCount:b,userLanguage:y}))),w={createLocalApiErrorHandler:Object(p.d)("CONVERSATION_SCREEN"),googleAnalyticsPageView:g.a,scribePageImpression:g.d,clearTimelineCache:(e,t)=>Object(b.a)(e,t)};var P=Object(_.g)(L,w),v=a("ymux"),C=a("rkhm"),B=a("SrtL"),x=a("8UdT"),D=a("dwig"),R=a("kGix"),F=a("JyI6"),j=a("3XMw"),q=a.n(j),N=a("dFWS");const G=q.a.d2c7a41c,M=q.a.e20404df,U=q.a.d17df547;var H=({getLocationState:e,history:t})=>c.createElement(F.a,{accessibilityLabel:G,getLocationState:e,history:t,icon:c.createElement(N.a,null),label:U,scribeComponent:"floating_reply_button",shortLabel:M}),V=a("muX9"),z=a("zb92");var Q=Object(z.a)({loader:()=>Promise.all([a.e(0),a.e(161)]).then(a.bind(null,"uo3S")),renderPlaceholder:(e,t)=>null}),$=a("/yvb"),X=a("sebV"),W=a("BXlL"),J=a("Irs7"),K=a("aITJ");const Z=q.a.af9c8a3d;var Y=({isLoggedIn:e,featureSwitches:t,scribeNamespace:a,startLocation:r})=>{const n=Object(J.b)(),o=e&&K.b.isMobileOS()&&!X.a.isStandaloneApp(),i=c.useCallback((e=>{e.preventDefault(),n.scribe({...a,element:"open_app_button",action:"click"}),Object(W.b)({startLocation:r})}),[n,a,r]);return o&&t.isTrue("responsive_web_open_app_appbar_button_enabled")?c.createElement($.a,{accessibilityLabel:Z,children:Z,onPress:i,size:"small",type:"secondary"}):null},ee=a("rJoH"),te=a("yoO3"),ae=a("AUxQ"),re=a("QIgh"),ne=a("oQhu"),oe=a("BV3T"),ce=a("VTxf"),ie=a("7BdX"),se=a("SrIh"),le=a("fTQJ"),de=a("ZNT5");var ue=e=>{const{richLandingContextId:t,statusId:a}=e;return((e,t)=>Object(de.a)({timelineId:`rich-tweet-landing-${e}`,getEndpoint:e=>e.URT.fetchRichTweetLandingTimeline,getEndpointParams:e=>({...e,...t}),context:"FETCH_RICH_TWEET_LANDING",perfKey:"rich-tweet-landing"}))(t?`${a}-${t}`:a,{refsrc_tweet:a,rux_cxt:t})},ge=a("wgnn");const me=e=>{switch(e){case ge.a.NOT_FOUND:return c.createElement(ce.a,null);case ge.a.NOT_ALLOWED:return c.createElement(oe.a,null);default:return Object(se.a)(`Unhandled timeline unavailable reason: ${e}`),null}},pe=()=>c.createElement(ce.a,null);class he extends c.Component{constructor(...e){super(...e),n()(this,"_getMemoizedModule",Object(ne.a)(((e,t)=>ue({statusId:e,richLandingContextId:t})))),n()(this,"_getModule",(()=>{const{statusId:e,richLandingContextId:t}=this.props;return this._getMemoizedModule(e,t)}))}render(){const{title:e}=this.props;return c.createElement(le.a,{entryConfiguration:re.b,module:this._getModule(),prerollDisplayLocation:ie.e.OTHER,renderEmptyState:pe,renderUnavailable:me,title:e})}}var _e=a("Rp9C"),be=a("7JQg");const ye=Object.freeze({Email:"email"});var Ee=a("VS6U"),fe=a("HBr9");a("E4zi"),a("P1HC"),a("876e");var Ae=a("G8HL"),Te=a("mN6z");const Oe=q.a.heb3a84c,ke=q.a.a90e1e67({noun:""}),Ie=q.a.c299a6cf,Se=q.a.ad666301,Le=q.a.f0c37ddb,we={page:"tweet"},Pe={page:"tweet",section:"landing"},ve=Object(ne.a)(((e,t)=>({items:[_e.a.forTweet(e,t)],tweet_id:e}))),Ce=Object(ne.a)((e=>Object(C.a)(e))),Be=Object(ne.a)(((e,t,a)=>{var r,n;return{referrer:e,controller_data:e&&(null==t||null==(r=t.details)||null==(n=r.timelinesDetails)?void 0:n.controllerData),overflowCount:a}})),xe=Object(ne.a)(((e,t)=>Object(v.a)({focalTweetId:e,fetchOptions:t})));class De extends c.Component{constructor(e,t){super(e,t),n()(this,"_getFabState",(()=>{const{promotedContent:e,statusId:t}=this.props;return{inReplyToStatusId:t,promotedContent:e}})),n()(this,"_shouldRedirectToOcfLiteLogin",(()=>{const{location:e}=this.props,{loggedInUserId:t}=this.context;return(({isUserLoggedIn:e,location:t})=>(e=>{const{query:t}=e;return"refsrc"in t&&"string"==typeof t.refsrc?t.refsrc:""})(t)===ye.Email&&!e)({isUserLoggedIn:!!t,location:e})&&this._isOcfLiteLoginEnabled})),n()(this,"_isBucketedInRichTweetLandingExperiment",(()=>{const{isReferralSource:e,isReferredFromExploreTopics:t,richLandingContextId:a}=this.props;return!(a||!e||t)&&this.context.featureSwitches.isTrue("responsive_web_rich_tweet_landing_enabled")})),n()(this,"_getNavigationParams",(()=>{const{tweetDetailNav:e,contextualClientEventInfo:t,overflowCount:a}=this.props;return Be(e,t,a)})),n()(this,"_getModule",(()=>{const{statusId:e}=this.props,t=this._getNavigationParams();return xe(e,t)})),n()(this,"_handleEntriesRendered",(({entries:e,fetchStatus:t})=>{const{recordTTFL:a}=this.props;if(t===R.a.FAILED&&(this._shouldRecordTTFL=!1),this._shouldRecordTTFL&&e.length){const t=e.some((({type:e})=>e===x.b.Tweet));this._shouldRecordTTFL=!1,t&&a&&a("permalink")}})),n()(this,"_shouldRedirectToCanonical",(()=>{var e;const{focalTweet:t,screenName:a,selectedTweetId:r,statusId:n}=this.props;return!(r!==n||null==t||null==(e=t.user)||!e.screen_name)&&(a&&t&&a.toLowerCase()!==t.user.screen_name.toLowerCase())})),n()(this,"_redirectToCanonical",(()=>{const{history:e,location:t}=this.props;e.replace({pathname:this._getCanonicalPath(),query:t.query,state:t.state})})),n()(this,"_getCanonicalPath",(()=>{const{focalTweet:e}=this.props;return e?`/${e.user.screen_name}/status/${e.id_str}`:"/"})),n()(this,"_getPathForTweetId",((e,t)=>`/${t||"i"}/status/${e}`)),n()(this,"_getScribeNamespace",(()=>this._shouldRenderRichTweetLandingTimeline()?Pe:we)),this._shouldRecordTTFL=e.isInitialScreen,this._isInlineReplyEnabled=this.context.featureSwitches.isTrue("responsive_web_inline_reply_enabled"),this._isInlineReplyWithFabEnabled=this.context.featureSwitches.isTrue("responsive_web_inline_reply_with_fab_enabled"),this._isOcfLiteLoginEnabled=this.context.featureSwitches.isTrue("responsive_web_ocf_lite_login_flow_enabled")}shouldComponentUpdate(e){return!Object(Te.a)(e,this.props)}componentDidMount(){const{history:e,location:t,isForwardNavigation:a}=this.props;if(this._shouldRedirectToOcfLiteLogin())e.push("/i/flow/lite_login");else{if(this._shouldRenderRichTweetLandingTimeline()&&(!t.state||!t.state.isRichTweetLanding)){const a={...t,state:{...t.state,isRichTweetLanding:!0}};e.replace(a)}a&&this._clearTimelineCache()}}componentWillUnmount(){this.context.setBackgroundClickHandler(null)}componentDidUpdate(e){this._shouldRedirectToCanonical()&&!this._shouldRedirectToOcfLiteLogin()?this._redirectToCanonical():this.props.statusId!==e.statusId&&this.props.isForwardNavigation&&this._clearTimelineCache()}render(){const{loggedInUserId:e}=this.context,{focalTweet:t,history:a,promotedContent:r,statusId:n,startLocation:o,userLanguage:s}=this.props,u=t?Le({tweetText:t.text,fullName:t.user.name}):void 0,g=t&&`twitter://status?id=${t.id_str}`,m=t&&`https://twitter.com${this._getCanonicalPath()||""}`,p=t&&Se({fullName:t.user.name});return c.createElement(be.b,{data:ve(n,r),namespace:this._getScribeNamespace()},c.createElement(te.a,null,m?c.createElement(V.a,null,c.createElement("link",{href:m,rel:"canonical"}),c.createElement("link",{href:`https://publish.twitter.com/oembed?url=${m}`,rel:"alternate",title:u,type:"application/json+oembed"})):null,null,c.createElement(ee.a,{canonical:m,description:null==t?void 0:t.full_text,image:null==t?void 0:t.user.profile_image_url_https,title:p,type:"article"}),c.createElement(d.a,{featureSwitches:this.context.featureSwitches,loggedInUserId:e,userLanguage:s}),c.createElement(l.a,{deepLink:g}),m?c.createElement(i.a,{canonical:m}):null,c.createElement(Ee.a,{backLocation:"/",documentTitle:u,history:a,primaryContent:this._renderTimeline(),rightControl:c.createElement(Y,{featureSwitches:this.context.featureSwitches,isLoggedIn:!!e,scribeNamespace:this._getScribeNamespace(),startLocation:o}),sidebarContent:this._renderSidebarContent(),title:t&&t.self_thread?Ie:ke}),c.createElement(B.a,{title:u,withMeta:!1})))}_renderSidebarContent(){const{focalTweet:e}=this.props;return e&&e.user.id_str?c.createElement(u.a,{withTopicsToFollow:!1,withWhoToFollow:!1},c.createElement(Q,{focalTweetId:e.id_str})):null}_renderTimeline(){const{focalTweet:e,history:t,location:a,richLandingContextId:r,rootTweet:n,screenName:o,selectedTweetId:i,statusId:s,socialContext:l,promotedContent:d,contextTweetId:u}=this.props,g={selectedTweetId:i},m=this._isInlineReplyEnabled&&!this._isInlineReplyWithFabEnabled?null:c.createElement(H,{getLocationState:this._getFabState,history:t});return c.createElement(D.a,{fab:m},c.createElement(fe.a,{itemListName:Oe},this._shouldRenderRichTweetLandingTimeline()?c.createElement(he,{richLandingContextId:r,statusId:s,title:ke}):c.createElement(ae.a,{apiErrorHandlerMap:Ce(o),contextTweetId:u,fetchOptions:this._getNavigationParams(),focalTweet:e,focalTweetId:s,location:a,module:this._getModule(),onEntriesRendered:this._handleEntriesRendered,promotedContent:d,rootTweet:n||void 0,selectedTweet:g,socialContext:l})))}_shouldRenderRichTweetLandingTimeline(){const{isReferredFromExploreTopics:e,richLandingContextId:t}=this.props;return!!t||e||this._isBucketedInRichTweetLandingExperiment()}_clearTimelineCache(e=this._getModule(),t=this._getNavigationParams()){const{clearTimelineCache:a,createLocalApiErrorHandler:r,screenName:n}=this.props;a(e,t).catch(r(Ce(n)))}}n()(De,"contextType",s.a),n()(De,"defaultProps",{recordTTFL:o.c});t.default=P(Object(Ae.a)(De))}}]);
//# sourceMappingURL=https://ton.twitter.com/responsive-web-internal/sourcemaps/client-web/bundle.Conversation.4f8b69a5.js.map